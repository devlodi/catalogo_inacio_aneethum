<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loja de Produtos</title>
    <style>
          body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f9f9f9;
        }

        #produtos {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .card {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            width: 100%;
            box-sizing: border-box;
        }

        .card img {
            max-width: 100%;
            border-radius: 4px;
            display: block;
            margin: auto;
        }

        .card-title {
            font-size: 1.2em;
            margin: 0 0 10px;
        }

        .card-text {
            margin: 0;
        }

        @media(min-width: 768px) {
            .card {
                width: calc(33.333% - 20px);
            }
        }

    #carrinho {
            position: fixed;
            top: 0;
            right: 0;
            background-color: #fff;
            border: 1px solid #ddd;
            padding: 20px;
            display: none;
        }

        #carrinho.ativo {
            display: block;
        }

        .btn {
            padding: 10px 20px;
            background-color: #008CBA;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
    </style>
    <!-- PapaParse -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>

<body>

     <div id="header">
        <button class="btn" onclick="toggleCarrinho()">Carrinho</button>
    </div>

    <div id="produtos">
        <!-- Os produtos serão inseridos aqui pelo JavaScript -->
    </div>

    <div id="carrinho">
        <!-- Os itens do carrinho serão inseridos aqui pelo JavaScript -->
        <button class="btn" onclick="enviarPedido()">Mandar Pedido pelo WhatsApp</button>
    </div>

       <script type="text/javascript">
        var carrinho = [];
        var total = 0;

        function toggleCarrinho() {
            var carrinhoDiv = document.getElementById('carrinho');
            if (carrinhoDiv.classList.contains('ativo')) {
                carrinhoDiv.classList.remove('ativo');
            } else {
                carrinhoDiv.classList.add('ativo');
                atualizarCarrinho();
            }
        }

        function adicionarAoCarrinho(produto, preco) {
            carrinho.push({ produto: produto, preco: preco });
            total += parseFloat(preco);
            atualizarCarrinho();
        }

        function atualizarCarrinho() {
            var carrinhoDiv = document.getElementById('carrinho');
            var conteudoCarrinho = '';
            carrinho.forEach(item => {
                conteudoCarrinho += `<p>${item.produto} - R$ ${item.preco}</p>`;
            });
            conteudoCarrinho += `<p>Total: R$ ${total.toFixed(2)}</p>`;
            carrinhoDiv.innerHTML = conteudoCarrinho + '<button class="btn" onclick="enviarPedido()">Mandar Pedido pelo WhatsApp</button>';
        }

        function enviarPedido() {
            var mensagem = encodeURIComponent("Oi Inacio, quero estes produtos:\n" +
                carrinho.map(item => `${item.produto} - R$ ${item.preco}`).join('\n') +
                `\nTotal: R$ ${total.toFixed(2)}`);
            window.open(`https://wa.me/5551984424822?text=${mensagem}`);
        }

        // (O código para carregar os produtos da planilha, com a adição do botão "Colocar no Carrinho")
        Papa.parse('https://docs.google.com/spreadsheets/d/e/2PACX-1vTGy-7_SfKpf4b6HpIL2-f6JNugN8VPQPT_qfQb0gjoTn4qvh3Vyupbr4aVJcdmn1Sma3zlSYJQ0W_z/pub?output=csv', {
            download: true,
            header: true,
            complete: function(results) {
                var data = results.data;
                var productsContainer = document.getElementById('produtos');
                for (var i = 0; i < data.length; i++) {
                    var productCard = `
                        <div class="card">
                            <img src="${data[i].IMAGEM}" alt="${data[i].PRODUTOS}">
                            <h5 class="card-title">${data[i].PRODUTOS}</h5>
                            <p class="card-text">R$ ${data[i].PREÇO}</p>
                            <button class="btn" onclick="adicionarAoCarrinho('${data[i].PRODUTOS}', '${data[i].PREÇO}')">Colocar no Carrinho</button>
                        </div>`;
                    productsContainer.innerHTML += productCard;
                }
            }
        });
    </script>

</body>

</html>
