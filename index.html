<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalogo aneehtum inacio</title>
<style>
    body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background-color: #f9f9f9;
        margin-top: 100px; /* Espaço para o cabeçalho */
    }

    #produtos {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
    }

    .card {
        background-color: #fff;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        width: 100%;
        box-sizing: border-box;
    }

    .card img {
        max-width: 100%;
        border-radius: 4px;
        display: block;
        margin: auto;
    }

    .card-title {
        font-size: 1.2em;
        margin: 0 0 10px;
    }

    .card-text {
        margin: 0;
    }

    @media(min-width: 768px) {
        .card {
            width: calc(33.333% - 20px);
        }
    }

    #header {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background-color: #fff;
        border-bottom: 1px solid #ddd;
        padding: 10px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        z-index: 1000;
    }

    .btn {
        padding: 10px 20px;
        background-color: #008CBA;
        color: #fff;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }

    #contador {
        margin-left: 10px;
        background-color: #a80303;
        color: #fff;
        border-radius: 50%;
        padding: 5px 10px;
    }

    #detalhesCarrinho {
        display: none;
    }

    #header.ativo #detalhesCarrinho {
        display: block;
    }
 .instrucoes {
        background-color: #e0f7fa;
        padding: 20px;
        margin-bottom: 20px;
        border-radius: 8px;
        font-size: 1em;
    }
.modal {
    display: none;
    position: fixed;
    z-index: 1001;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.4);
    padding-top: 60px;
    transition: opacity 0.3s ease-in-out;
    opacity: 0;
}

.modal-content {
    background-color: #fefefe;
    margin: 5% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
    border-radius: 8px; /* Adicionado para bordas arredondadas */
    box-shadow: 0 4px 8px rgba(0,0,0,0.2); /* Adicionado para sombra */
}

.close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
}

.close:hover,
.close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
}

/* CSS adicionado para mostrar o modal */
.modal.show {
    display: block;
    opacity: 1;
}
</style>

    <!-- PapaParse -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>

<body>

     <div id="header">
        <button class="btn" onclick="toggleCarrinho()">Carrinho<span id="contador">0</span></button>
        <div id="detalhesCarrinho">
            <!-- Os itens do carrinho e o total serão inseridos aqui pelo JavaScript -->
        </div>
    </div>
    
    <div id="produtos">
    <div class="instrucoes">
        <p>Bem-vindo ao catalogo do Inacio! Aqui você pode ver todos os nossos produtos disponíveis. Para adicionar um item ao seu carrinho, basta clicar no botão "Colocar no Carrinho" abaixo do produto desejado. Você pode visualizar os itens no seu carrinho e o total da sua compra clicando no botão "Carrinho" no topo da página. Quando estiver pronto para finalizar a compra, clique em "Mandar Pedido pelo WhatsApp" no carrinho para enviar o seu pedido via WhatsApp.</p>
    </div>
    <!-- Os produtos serão inseridos aqui pelo JavaScript -->
</div>

<div id="myModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="fecharModal()">&times;</span>
        <p id="descricaoProduto"></p>
    </div>
</div>
    
   <script type="text/javascript">
        var carrinho = [];
        var total = 0;

        function toggleCarrinho() {
            var headerDiv = document.getElementById('header');
            if (headerDiv.classList.contains('ativo')) {
                headerDiv.classList.remove('ativo');
            } else {
                headerDiv.classList.add('ativo');
            }
        }

        function parsePreco(preco) {
            return parseFloat(preco.replace(',', '.').replace('R$ ', ''));
        }

        function adicionarAoCarrinho(produto, preco) {
            preco = parsePreco(preco);  // Converta a string de preço para um número
            if (isNaN(preco)) {
                console.error('Preço inválido:', preco);
                return;
            }
            carrinho.push({ produto: produto, preco: preco });
            total += preco;  // Adicione o preço ao total
            document.getElementById('contador').innerText = carrinho.length;
            atualizarCarrinho();
        }

     function atualizarCarrinho() {
    var detalhesCarrinho = document.getElementById('detalhesCarrinho');
    var conteudoCarrinho = '';
    carrinho.forEach((item, index) => {
        conteudoCarrinho += `
            <p>
                ${item.produto} - R$ ${item.preco.toFixed(2)}
                <span onclick="removerDoCarrinho(${index})" style="cursor:pointer;">&#128465;</span>
            </p>`;
    });
    conteudoCarrinho += `<p>Total: R$ ${total.toFixed(2)}</p>`;
    conteudoCarrinho += '<button class="btn" onclick="enviarPedido()">Mandar Pedido pelo WhatsApp</button><br>';
    detalhesCarrinho.innerHTML = conteudoCarrinho;
    document.getElementById('contador').innerText = carrinho.length;
}


        function enviarPedido() {
            var mensagem = encodeURIComponent("Oi Inacio, quero estes produtos:\n" +
                carrinho.map(item => `${item.produto} - R$ ${item.preco.toFixed(2)}`).join('\n\n') +
                `\nTotal: R$ ${total.toFixed(2)}`);
            window.open(`https://wa.me/5551984424822?text=${mensagem}`);
        }

function abrirModal(descricao) {
    var modal = document.getElementById("myModal");
    var descricaoProduto = document.getElementById("descricaoProduto");
    descricaoProduto.innerText = decodeURIComponent(descricao);
    modal.classList.add('show');
}

function fecharModal() {
    var modal = document.getElementById("myModal");
    modal.classList.remove('show');
}

        function removerDoCarrinho(index) {
        total -= carrinho[index].preco;  // Subtrai o preço do item do total
        carrinho.splice(index, 1);  // Remove o item do carrinho
        atualizarCarrinho();
    }

   function atualizarCarrinho() {
    var detalhesCarrinho = document.getElementById('detalhesCarrinho');
    var conteudoCarrinho = '';
    var listaItens = '';
    carrinho.forEach((item, index) => {
        listaItens += `
            <p>
                ${item.produto} - R$ ${item.preco.toFixed(2)}
                <span onclick="removerDoCarrinho(${index})" style="cursor:pointer;">&#128465;</span>
            </p>`;
    });
    listaItens += `<p>Total: R$ ${total.toFixed(2)}</p>`;
    conteudoCarrinho = `
        <div>
            ${listaItens}
        </div>
        <button class="btn" onclick="enviarPedido()">Mandar Pedido pelo WhatsApp</button><br>
    `;
    detalhesCarrinho.innerHTML = conteudoCarrinho;
    document.getElementById('contador').innerText = carrinho.length;
}


// ... (o código para carregar os produtos da planilha) ...
Papa.parse('https://docs.google.com/spreadsheets/d/e/2PACX-1vTGy-7_SfKpf4b6HpIL2-f6JNugN8VPQPT_qfQb0gjoTn4qvh3Vyupbr4aVJcdmn1Sma3zlSYJQ0W_z/pub?output=csv', {
    download: true,
    header: true,
    complete: function(results) {
        var data = results.data;
        var productsContainer = document.getElementById('produtos');
        for (var i = 0; i < data.length; i++) {
            var descricaoEscapada = encodeURIComponent(data[i].DESCRIÇÃO);
            var productCard = `
                <div class="card">
                    <img src="${data[i].IMAGEM}" alt="${data[i].PRODUTOS}">
                    <h5 class="card-title">${data[i].PRODUTOS}</h5>
                    <button onclick="abrirModal('${descricaoEscapada}')">Mais Sobre</button>
                    <p class="card-text">R$ ${data[i].PREÇO}</p>
                    <button class="btn" onclick="adicionarAoCarrinho('${data[i].PRODUTOS}', '${data[i].PREÇO}')">Colocar no Carrinho</button>
                </div>`;
            productsContainer.innerHTML += productCard;
        }
    }
});
    </script>

</body>

</html>
